#!/usr/bin/env bash
set +x
kubectl delete -f cnx-overview-demo/stage2 > /dev/null 2>&1
kubectl delete -f cnx-overview-demo/stage1 > /dev/null 2>&1
kubectl apply -f cnx-overview-demo/stage0/po-database.yaml > /dev/null 2>&1
kubectl patch pod -n dev $(kubectl get pods -n dev | grep rogue | awk '{print $1}') --type=json -p '[{"op": "remove", "path": "/metadata/labels/quarantine"}]' > /dev/null 2>&1
kubectl get globalnetworkpolicy -l 'projectcalico.org/tier=security-operations' | grep security-op | awk '{print $1}' | grep -v quarantine | xargs -n1 kubectl delete globalnetworkpolicy > /dev/null 2>&1
#kubectl --as=bob apply -f cnx-overview-demo/stage0 > /dev/null 2>&1
